spring:
  application:
    name: ${APP_NAME:ApiGateway}

  main:
    allow-bean-definition-overriding: true
    web-application-type: reactive

  cloud:
    gateway:
      discovery:
        locator:
          enabled: false     # when true â†’ routes are auto-created
          lower-case-service-id: true

      routes:
        # =======================
        # USER SERVICE
        # =======================
        - id: user-service
          uri: lb://USERSERVICE
          predicates:
            - Path=/userservice/**
          filters:
            - StripPrefix=1

        # =======================
        # PRODUCT SERVICE
        # =======================
        - id: product-service
          uri: lb://PRODUCTSERVICE
          predicates:
            - Path=/productservice/**
          filters:
            - StripPrefix=1

        # =======================
        # ORDER SERVICE
        # =======================
        - id: order-service
          uri: lb://ORDERSERVICE
          predicates:
            - Path=/orderservice/**
          filters:
            - StripPrefix=1

        # =======================
        # INVENTORY SERVICE
        # =======================
        - id: inventory-service
          uri: lb://INVENTORYSERVICE
          predicates:
            - Path=/inventoryservice/**
          filters:
            - StripPrefix=1

        # =======================
        # PAYMENT SERVICE
        # =======================
        - id: payment-service
          uri: lb://PAYMENTSERVICE
          predicates:
            - Path=/paymentservice/**
          filters:
            - StripPrefix=1


server:
  port: ${PORT:8080}


eureka:
  client:
    service-url:
      defaultZone: ${EUREKA_URL:http://localhost:8761/eureka}
    register-with-eureka: true
    fetch-registry: true

  instance:
    prefer-ip-address: true
    instance-id: ${spring.application.name}:${PORT}


logging:
  level:
    org.springframework.security: DEBUG
    org.springframework.cloud.gateway: DEBUG